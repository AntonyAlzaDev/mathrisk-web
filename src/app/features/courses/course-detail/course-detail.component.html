<div class="course-detail-page" *ngIf="!loading() && course()">
  <!-- Hero Section -->
  <section class="course-hero" [style.backgroundImage]="'url(' + course()!.featuredImage + ')'">
    <div class="hero-overlay"></div>
    <div class="container hero-content">
      <div class="breadcrumb">
        <a routerLink="/cursos">Cursos</a>
        <span>/</span>
        <span>{{ course()!.title }}</span>
      </div>
      <h1>{{ course()!.title }}</h1>
      <p class="hero-description">{{ course()!.description }}</p>
      <div class="hero-meta">
        <span class="badge">{{ course()!.level }}</span>
        <span class="badge">{{ course()!.duration }} horas</span>
        <span class="badge badge-status">{{ course()!.status }}</span>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <section class="course-content">
    <div class="container">
      <div class="content-grid">
        <!-- Left Column -->
        <div class="content-main">
          <!-- Descripción -->
          <div class="content-section">
            <h2>Acerca del curso</h2>
            <p class="long-description">{{ course()!.longDescription }}</p>
          </div>

          <!-- Lo que aprenderás -->
          <div class="content-section" *ngIf="course()!.whatYouWillLearn?.length">
            <h2>Lo que aprenderás</h2>
            <ul class="learning-list">
              <li *ngFor="let item of course()!.whatYouWillLearn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"/>
                </svg>
                {{ item }}
              </li>
            </ul>
          </div>

          <!-- Temario -->
          <div class="content-section" *ngIf="course()!.syllabus?.length">
            <h2>Temario del curso</h2>
            <div class="syllabus">
              <div class="module" *ngFor="let module of course()!.syllabus">
                <div class="module-header">
                  <h3>Módulo {{ module.moduleNumber }}: {{ module.title }}</h3>
                  <span class="module-duration">{{ module.duration }}h</span>
                </div>
                <ul class="module-topics">
                  <li *ngFor="let topic of module.topics">{{ topic }}</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Requisitos -->
          <div class="content-section" *ngIf="course()!.requirements?.length">
            <h2>Requisitos</h2>
            <ul class="requirements-list">
              <li *ngFor="let req of course()!.requirements">{{ req }}</li>
            </ul>
          </div>

          <!-- Instructor -->
          <div class="content-section instructor-section">
            <h2>Instructor</h2>
            <div class="instructor-card-detail">
              <img 
                [src]="course()!.instructor.photo" 
                [alt]="course()!.instructor.name"
                class="instructor-photo-large">
              <div class="instructor-details">
                <h3>{{ course()!.instructor.name }}</h3>
                <p class="instructor-title">{{ course()!.instructor.title }}</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column - Sidebar -->
        <div class="content-sidebar">
          <div class="sticky-sidebar">
            <!-- Course Card -->
            <div class="sidebar-card">
              <div class="course-price-large">
                <span class="original-price" *ngIf="course()!.originalPrice > course()!.discountedPrice">
                  S/ {{ course()!.originalPrice }}
                </span>
                <span class="current-price">S/ {{ course()!.discountedPrice }}</span>
                <span class="discount-badge" *ngIf="course()!.discountPercentage > 0">
                  -{{ course()!.discountPercentage }}% OFF
                </span>
              </div>

              <div class="course-info-list">
                <div class="info-item">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                    <line x1="16" y1="2" x2="16" y2="6"/>
                    <line x1="8" y1="2" x2="8" y2="6"/>
                    <line x1="3" y1="10" x2="21" y2="10"/>
                  </svg>
                  <div>
                    <strong>Fecha de inicio</strong>
                    <span>{{ formatDate(course()!.startDate) }}</span>
                  </div>
                </div>

                <div class="info-item">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12 6 12 12 16 14"/>
                  </svg>
                  <div>
                    <strong>Duración</strong>
                    <span>{{ course()!.duration }} horas</span>
                  </div>
                </div>

                <div class="info-item">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                  </svg>
                  <div>
                    <strong>Cupos disponibles</strong>
                    <span>{{ course()!.maxStudents - course()!.enrolledStudents }} de {{ course()!.maxStudents }}</span>
                  </div>
                </div>

                <div class="info-item">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                  </svg>
                  <div>
                    <strong>Nivel</strong>
                    <span>{{ course()!.level }}</span>
                  </div>
                </div>
              </div>

              <button class="btn btn-primary btn-full btn-lg" (click)="toggleEnrollForm()">
                Inscribirme ahora
              </button>

              <button class="btn btn-secondary btn-full" routerLink="/contacto">
                Consultar
              </button>

              <div class="launch-offer-sidebar" *ngIf="course()!.launchOffer?.active">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                </svg>
                <p>{{ course()!.launchOffer.message }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<!-- Loading State -->
<div class="loading-page" *ngIf="loading()">
  <div class="spinner"></div>
  <p>Cargando información del curso...</p>
</div>

<!-- Not Found State -->
<div class="not-found-page" *ngIf="!loading() && !course()">
  <div class="container text-center">
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"/>
      <line x1="12" y1="8" x2="12" y2="12"/>
      <line x1="12" y1="16" x2="12.01" y2="16"/>
    </svg>
    <h2>Curso no encontrado</h2>
    <p>El curso que buscas no existe o ha sido eliminado.</p>
    <a routerLink="/cursos" class="btn btn-primary">Ver todos los cursos</a>
  </div>
</div>
